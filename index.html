<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í´ë¦¬ë…¸ë¯¸í„° í™œë™ ìˆœì„œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .content {
            padding: 30px;
        }

        .activity-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .activity-table th {
            background: linear-gradient(135deg, #ffeaa7, #fdcb6e);
            padding: 15px 10px;
            text-align: center;
            font-weight: bold;
            border: 2px solid #ddd;
            font-size: 14px;
        }

        .activity-table td {
            padding: 15px 10px;
            border: 2px solid #ddd;
            text-align: center;
            background: white;
        }

        .activity-table tr:nth-child(even) td {
            background: #f8f9ff;
        }

        .step-number {
            background: linear-gradient(135deg, #ff7675, #fd79a8);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin: 0 auto;
        }

        .input-section {
            background: linear-gradient(135deg, #a29bfe, #74b9ff);
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
            color: white;
        }

        .input-section h3 {
            margin-bottom: 20px;
            font-size: 1.3em;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        .form-group textarea {
            height: 80px;
            resize: vertical;
        }

        .photo-upload {
            background: white;
            color: #333;
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .photo-upload:hover {
            border-color: #74b9ff;
            background: #f8f9ff;
        }

        .photo-upload.dragover {
            border-color: #00b894;
            background: #d1f2eb;
        }

        .preview-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .preview-image {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
        }

        .preview-image img {
            width: 100%;
            height: 120px;
            object-fit: cover;
        }

        .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .save-btn {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            box-shadow: 0 5px 15px rgba(0,184,148,0.4);
            transition: all 0.3s ease;
            min-width: 150px;
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(0,184,148,0.6);
        }

        .notice {
            background: linear-gradient(135deg, #ff6b6b, #ffa8a8);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .notice h4 {
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .measurement-diagram {
            background: #f8f9ff;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .angle-input {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .angle-input input {
            width: 80px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            .content {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .activity-table th,
            .activity-table td {
                padding: 10px 5px;
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”­ í´ë¦¬ë…¸ë¯¸í„° í™œë™ ìˆœì„œ</h1>
            <p>ì•¼ì™¸ì—ì„œ ê±´ë¬¼ê³¼ ë‚˜ë¬´ì˜ ë†’ì´ë¥¼ êµ¬í•´ ë³´ì!</p>
        </div>

        <div class="content">
            <!-- í™œë™ ìˆœì„œí‘œ -->
            <table class="activity-table">
                <thead>
                    <tr>
                        <th>ìˆœì„œ</th>
                        <th>ë‚´ìš©</th>
                        <th>í´ë¦¬ë…¸ë¯¸í„°<br>ë‹´ë‹¹</th>
                        <th>ê¸°ë¡ ë‹´ë‹¹</th>
                        <th>ì¤„ì ë‹´ë‹¹</th>
                        <th>í™œìš© ë‹´ë‹¹</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><div class="step-number">1</div></td>
                        <td><strong>ëŒ€ìƒ ë¬¼ì§ˆ</strong></td>
                        <td>ì¸¡ì • ì¤€ë¹„</td>
                        <td>ì¸¡ì • ì¤€ë¹„</td>
                        <td>ì¸¡ì • ì¤€ë¹„</td>
                        <td><strong>ì¸¡ì • ì „</strong><br>ë†’ì´ë¥¼ ì¬ê³ ì í•˜ëŠ”<br>ëŒ€ìƒì„ ë¨¼ì € í™œìš©</td>
                    </tr>
                    <tr>
                        <td><div class="step-number">2</div></td>
                        <td><strong>ì¸¡ì • ë°<br>ê¸°ë¡</strong></td>
                        <td>ê¸´ ì¤„ìë¡œ ì„¤ í›„<br>í´ë¦¬ë…¸ë¯¸í„°ì—<br>ì˜í•´<br>íƒ‘ë©´ì„ í†µí•´<br>ëŒ€ìƒì„ ê´€ì°°<br>(ìŒì•…ê¹Œì§€ ìœ ìŒ)</td>
                        <td>1. í´ë¦¬ë…¸ë¯¸í„°ì—<br>í‘œì‹œëœ ê°ë„ ê¸°ë¡<br>2. ì§€ë©´ ì¸¡ì •<br>3. í´ë¦¬ë…¸ë¯¸í„°<br>ë‹´ë‹¹ í•™ìƒ ë†’ì´<br>ì¸¡ì •</td>
                        <td><strong>í´ë¦¬ë…¸ë¯¸í„°<br>ì‚¬ìš©ì ì„¤ì •ì—ì„œ<br>ëŒ€ìƒê³¼ì˜ ê±°ë¦¬<br>ì¸¡ì •</strong><br>2. ì§€ë©´ìœ¼ë¡œë¶€í„°<br>í•™ìƒì˜ ëˆˆê¹Œì§€<br>ì˜ ë†’ì´ ì¸¡ì •</td>
                        <td>ëª¨ë“ ì›ì´<br>ì—­í• ì„ ë°”ê¾¸ì–´<br>íœ´ëŒ€í°ìœ¼ë¡œ<br>ì˜ìƒí™”</td>
                    </tr>
                    <tr>
                        <td><div class="step-number">3</div></td>
                        <td><strong>ë³´ê³ ì„œ<br>ì‘ì„±</strong></td>
                        <td>ê³„ì‚° ë°<br>ë³´ê³ ì„œ ì‘ì„±</td>
                        <td>ê³„ì‚° ë°<br>ë³´ê³ ì„œ ì‘ì„±</td>
                        <td>ê³„ì‚° ë°<br>ë³´ê³ ì„œ ì‘ì„±</td>
                        <td>ê³„ì‚° ë°<br>ë³´ê³ ì„œ ì‘ì„±</td>
                    </tr>
                    <tr>
                        <td><div class="step-number">4</div></td>
                        <td colspan="5"><strong>1~3ë²ˆ í•­ëª© í•œë²ˆ ë”</strong></td>
                    </tr>
                    <tr>
                        <td><div class="step-number">5</div></td>
                        <td colspan="5"><strong>êµì‚¬ì—ê²Œ ì œì¶œ</strong></td>
                    </tr>
                </tbody>
            </table>

            <!-- ì£¼ì˜ì‚¬í•­ -->
            <div class="notice">
                <h4>âš ï¸ ì£¼ì˜ì‚¬í•­</h4>
                <p>â€¢ ì¶œì ì¸¡ì •ì‹œ ìœ„í—˜í•œ ë¶€ë¶„ì´ ìˆê¸° ë•Œë¬¸ì— íŠ¹ë³„íˆ ì£¼ì˜í•  ê²ƒ.<br>
                â€¢ ì¥ë‚œì‹ ì‹œ í•´ë‹¹ ëª¨ë‘ ì€ í¬íŠ¸í´ë¦¬ì˜¤ ìˆ˜í–‰í‰ê°€ì— ë¶ˆì´ìµì´ ìˆìŒ.</p>
            </div>

            <!-- ì¸¡ì • ê²°ê³¼ ì…ë ¥ ì„¹ì…˜ -->
            <div class="input-section">
                <h3>ğŸ“Š ì¸¡ì • ê²°ê³¼ ê¸°ë¡</h3>
                
                <div class="form-group">
                    <label>ëª¨ë‘ ëª…:</label>
                    <input type="text" id="teamName" placeholder="ëª¨ë‘ ëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>

                <div class="form-group">
                    <label>ì¸¡ì • ëŒ€ìƒ 1:</label>
                    <input type="text" id="target1" placeholder="ì˜ˆ: í•™êµ ê±´ë¬¼, í° ë‚˜ë¬´ ë“±">
                </div>

                <div class="form-group">
                    <label>í´ë¦¬ë…¸ë¯¸í„° ê°ë„ (ì²« ë²ˆì§¸ ì¸¡ì •):</label>
                    <div class="angle-input">
                        <input type="number" id="angle1" placeholder="ê°ë„"> <span>Â°</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>ëŒ€ìƒê³¼ì˜ ê±°ë¦¬ (ì²« ë²ˆì§¸ ì¸¡ì •):</label>
                    <div class="angle-input">
                        <input type="number" id="distance1" placeholder="ê±°ë¦¬"> <span>m</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>ê´€ì°°ì ëˆˆë†’ì´ (ì²« ë²ˆì§¸ ì¸¡ì •):</label>
                    <div class="angle-input">
                        <input type="number" id="eyeHeight1" placeholder="ë†’ì´"> <span>m</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>ê³„ì‚°ëœ ë†’ì´ (ì²« ë²ˆì§¸ ì¸¡ì •):</label>
                    <div class="angle-input">
                        <input type="number" id="calculatedHeight1" placeholder="ë†’ì´"> <span>m</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>ì¸¡ì • ëŒ€ìƒ 2:</label>
                    <input type="text" id="target2" placeholder="ì˜ˆ: í•™êµ ê±´ë¬¼, í° ë‚˜ë¬´ ë“±">
                </div>

                <div class="form-group">
                    <label>í´ë¦¬ë…¸ë¯¸í„° ê°ë„ (ë‘ ë²ˆì§¸ ì¸¡ì •):</label>
                    <div class="angle-input">
                        <input type="number" id="angle2" placeholder="ê°ë„"> <span>Â°</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>ëŒ€ìƒê³¼ì˜ ê±°ë¦¬ (ë‘ ë²ˆì§¸ ì¸¡ì •):</label>
                    <div class="angle-input">
                        <input type="number" id="distance2" placeholder="ê±°ë¦¬"> <span>m</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>ê´€ì°°ì ëˆˆë†’ì´ (ë‘ ë²ˆì§¸ ì¸¡ì •):</label>
                    <div class="angle-input">
                        <input type="number" id="eyeHeight2" placeholder="ë†’ì´"> <span>m</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>ê³„ì‚°ëœ ë†’ì´ (ë‘ ë²ˆì§¸ ì¸¡ì •):</label>
                    <div class="angle-input">
                        <input type="number" id="calculatedHeight2" placeholder="ë†’ì´"> <span>m</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>í™œë™ ì†Œê° ë° ëŠë‚€ ì :</label>
                    <textarea id="reflection" placeholder="í™œë™ì„ í†µí•´ ë°°ìš´ ì , ì–´ë ¤ì› ë˜ ì , ëŠë‚€ ì ì„ ììœ ë¡­ê²Œ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
                </div>
            </div>

            <!-- ì‚¬ì§„ ì—…ë¡œë“œ ì„¹ì…˜ -->
            <div class="input-section">
                <h3>ğŸ“¸ í™œë™ ì‚¬ì§„ ì—…ë¡œë“œ</h3>
                
                <div class="form-group">
                    <label>í™œë™ ì‚¬ì§„ë“¤ì„ ì—…ë¡œë“œí•˜ì„¸ìš”:</label>
                    <div class="photo-upload" id="photoUpload">
                        <p>ğŸ“· í´ë¦­í•˜ì—¬ ì‚¬ì§„ì„ ì„ íƒí•˜ê±°ë‚˜<br>ì—¬ê¸°ì— ì‚¬ì§„ì„ ë“œë˜ê·¸í•˜ì„¸ìš”</p>
                        <input type="file" id="photoInput" multiple accept="image/*" style="display: none;">
                    </div>
                    <div class="preview-container" id="previewContainer"></div>
                </div>
            </div>

            <!-- ì¸¡ì • ì›ë¦¬ ë‹¤ì´ì–´ê·¸ë¨ -->
            <div class="measurement-diagram">
                <h3>ğŸ“ í´ë¦¬ë…¸ë¯¸í„°ë¥¼ ì´ìš©í•œ ë†’ì´ ì¸¡ì • ì›ë¦¬</h3>
                <p><strong>ë†’ì´ = (ê±°ë¦¬ Ã— tan(ê°ë„)) + ê´€ì°°ì ëˆˆë†’ì´</strong></p>
                <p style="margin-top: 10px; color: #666;">
                    ì‚¼ê°í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ê±´ë¬¼ì´ë‚˜ ë‚˜ë¬´ì˜ ë†’ì´ë¥¼ ê°„ì ‘ì ìœ¼ë¡œ ì¸¡ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
            </div>

            <div style="text-align: center; flex-wrap: wrap; display: flex; justify-content: center; gap: 10px;">
                <button class="save-btn" onclick="saveAsHTML()">ğŸ“„ HTML ë³´ê³ ì„œ</button>
                <button class="save-btn" onclick="showResultSummary()" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">ğŸ“‹ ê²°ê³¼ ì •ë¦¬í•˜ê¸°</button>
                <button class="save-btn" onclick="saveAsCSV()" style="background: linear-gradient(135deg, #00cec9, #55a3ff);">ğŸ“Š CSV ë°ì´í„°</button>
                <button class="save-btn" onclick="submitToGoogleForm()" style="background: linear-gradient(135deg, #4285f4, #ea4335);">ğŸ“ êµ¬ê¸€í¼ ì œì¶œ</button>
            </div>

            <!-- êµ¬ê¸€í¼ ì„¤ì • ì„¹ì…˜ -->
            <div class="input-section" style="margin-top: 20px;">
                <h3>ğŸ“ êµ¬ê¸€í¼ ì œì¶œ ì„¤ì •</h3>
                <div class="form-group">
                    <label>êµ¬ê¸€í¼ URL:</label>
                    <input type="url" id="googleFormUrl" placeholder="êµ¬ê¸€í¼ URLì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: https://forms.gle/xxxxx)">
                    <small style="display: block; margin-top: 5px; color: #ddd;">
                        ì„ ìƒë‹˜ì´ ë§Œë“  êµ¬ê¸€í¼ì˜ ë§í¬ë¥¼ ì—¬ê¸°ì— ì…ë ¥í•˜ì„¸ìš”.
                    </small>
                </div>
                <button onclick="showGoogleFormGuide()" style="background: #6c5ce7; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-bottom: 10px;">
                    ğŸ“‹ êµ¬ê¸€í¼ ì„¤ì • ê°€ì´ë“œ ë³´ê¸°
                </button>
                <p style="color: #ddd; font-size: 14px; margin-top: 10px;">
                    ğŸ’¡ <strong>êµ¬ê¸€í¼ ì œì¶œ ë°©ì‹:</strong><br>
                    í•™ìƒì´ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ êµ¬ê¸€í¼ì´ ìƒˆ ì°½ìœ¼ë¡œ ì—´ë¦¬ê³ ,<br>
                    ì¸¡ì • ë°ì´í„°ê°€ ìë™ìœ¼ë¡œ ë¯¸ë¦¬ ì…ë ¥ëœ ìƒíƒœë¡œ ë‚˜íƒ€ë‚©ë‹ˆë‹¤!<br>
                    ì‚¬ì§„ì€ êµ¬ê¸€í¼ì˜ íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
                </p>
            </div>
        </div>
    </div>

    <script>
        // ì‚¬ì§„ ì—…ë¡œë“œ ê¸°ëŠ¥
        const photoUpload = document.getElementById('photoUpload');
        const photoInput = document.getElementById('photoInput');
        const previewContainer = document.getElementById('previewContainer');
        let uploadedFiles = [];

        // í´ë¦­ìœ¼ë¡œ íŒŒì¼ ì„ íƒ
        photoUpload.addEventListener('click', () => {
            photoInput.click();
        });

        // ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥
        photoUpload.addEventListener('dragover', (e) => {
            e.preventDefault();
            photoUpload.classList.add('dragover');
        });

        photoUpload.addEventListener('dragleave', () => {
            photoUpload.classList.remove('dragover');
        });

        photoUpload.addEventListener('drop', (e) => {
            e.preventDefault();
            photoUpload.classList.remove('dragover');
            const files = Array.from(e.dataTransfer.files);
            handleFiles(files);
        });

        photoInput.addEventListener('change', (e) => {
            const files = Array.from(e.target.files);
            handleFiles(files);
        });

        function handleFiles(files) {
            files.forEach(file => {
                if (file.type.startsWith('image/')) {
                    uploadedFiles.push(file);
                    displayPreview(file, uploadedFiles.length - 1);
                }
            });
        }

        function displayPreview(file, index) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const previewDiv = document.createElement('div');
                previewDiv.className = 'preview-image';
                previewDiv.innerHTML = `
                    <img src="${e.target.result}" alt="ì—…ë¡œë“œëœ ì‚¬ì§„">
                    <button class="remove-image" onclick="removeImage(${index})">Ã—</button>
                `;
                previewContainer.appendChild(previewDiv);
            };
            reader.readAsDataURL(file);
        }

        function removeImage(index) {
            uploadedFiles.splice(index, 1);
            previewContainer.innerHTML = '';
            uploadedFiles.forEach((file, newIndex) => {
                displayPreview(file, newIndex);
            });
        }

        // HTML ë³´ê³ ì„œë¡œ ì €ì¥
        function saveAsHTML() {
            const data = {
                teamName: document.getElementById('teamName').value || 'ë¯¸ì…ë ¥',
                target1: document.getElementById('target1').value || 'ë¯¸ì…ë ¥',
                angle1: document.getElementById('angle1').value || 'ë¯¸ì…ë ¥',
                distance1: document.getElementById('distance1').value || 'ë¯¸ì…ë ¥',
                eyeHeight1: document.getElementById('eyeHeight1').value || 'ë¯¸ì…ë ¥',
                calculatedHeight1: document.getElementById('calculatedHeight1').value || 'ë¯¸ì…ë ¥',
                target2: document.getElementById('target2').value || 'ë¯¸ì…ë ¥',
                angle2: document.getElementById('angle2').value || 'ë¯¸ì…ë ¥',
                distance2: document.getElementById('distance2').value || 'ë¯¸ì…ë ¥',
                eyeHeight2: document.getElementById('eyeHeight2').value || 'ë¯¸ì…ë ¥',
                calculatedHeight2: document.getElementById('calculatedHeight2').value || 'ë¯¸ì…ë ¥',
                reflection: document.getElementById('reflection').value || 'ë¯¸ì…ë ¥',
                timestamp: new Date().toLocaleString()
            };

            // ì‚¬ì§„ì„ Base64ë¡œ ë³€í™˜í•˜ì—¬ HTMLì— í¬í•¨
            Promise.all(uploadedFiles.map(file => {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result);
                    reader.readAsDataURL(file);
                });
            })).then(photoDataList => {
                const photoHtml = photoDataList.map((photoData, index) => 
                    `<div class="photo-item">
                        <h4>ğŸ“· ì‚¬ì§„ ${index + 1}</h4>
                        <img src="${photoData}" style="max-width: 100%; height: auto; border-radius: 8px; margin: 10px 0;">
                    </div>`
                ).join('');

                const htmlContent = `
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í´ë¦¬ë…¸ë¯¸í„° í™œë™ ë³´ê³ ì„œ - ${data.teamName}</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            background: #f8f9fa;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2d3436;
            text-align: center;
            border-bottom: 3px solid #74b9ff;
            padding-bottom: 15px;
        }
        .info-section {
            background: #e8f4fd;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .measurement-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .measurement-table th {
            background: #74b9ff;
            color: white;
            padding: 12px;
            text-align: center;
        }
        .measurement-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }
        .measurement-table tr:nth-child(even) {
            background: #f8f9ff;
        }
        .reflection-section {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        .photo-section {
            margin: 30px 0;
        }
        .photo-item {
            margin: 20px 0;
            text-align: center;
        }
        .footer {
            text-align: center;
            color: #636e72;
            margin-top: 30px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”­ í´ë¦¬ë…¸ë¯¸í„° í™œë™ ë³´ê³ ì„œ</h1>
        
        <div class="info-section">
            <h2>ğŸ“‹ ê¸°ë³¸ ì •ë³´</h2>
            <p><strong>ëª¨ë‘ ëª…:</strong> ${data.teamName}</p>
            <p><strong>ì œì¶œì¼ì‹œ:</strong> ${data.timestamp}</p>
        </div>

        <h2>ğŸ“ ì¸¡ì • ê²°ê³¼</h2>
        <table class="measurement-table">
            <tr>
                <th>êµ¬ë¶„</th>
                <th>ì¸¡ì • ëŒ€ìƒ</th>
                <th>í´ë¦¬ë…¸ë¯¸í„° ê°ë„(Â°)</th>
                <th>ëŒ€ìƒê³¼ì˜ ê±°ë¦¬(m)</th>
                <th>ê´€ì°°ì ëˆˆë†’ì´(m)</th>
                <th>ê³„ì‚°ëœ ë†’ì´(m)</th>
            </tr>
            <tr>
                <td><strong>1ì°¨ ì¸¡ì •</strong></td>
                <td>${data.target1}</td>
                <td>${data.angle1}</td>
                <td>${data.distance1}</td>
                <td>${data.eyeHeight1}</td>
                <td>${data.calculatedHeight1}</td>
            </tr>
            <tr>
                <td><strong>2ì°¨ ì¸¡ì •</strong></td>
                <td>${data.target2}</td>
                <td>${data.angle2}</td>
                <td>${data.distance2}</td>
                <td>${data.eyeHeight2}</td>
                <td>${data.calculatedHeight2}</td>
            </tr>
        </table>

        <div class="reflection-section">
            <h2>ğŸ’­ í™œë™ ì†Œê° ë° ëŠë‚€ ì </h2>
            <p>${data.reflection.replace(/\n/g, '<br>')}</p>
        </div>

        ${photoHtml ? `
        <div class="photo-section">
            <h2>ğŸ“¸ í™œë™ ì‚¬ì§„</h2>
            ${photoHtml}
        </div>
        ` : ''}

        <div class="footer">
            <p>í´ë¦¬ë…¸ë¯¸í„° í™œë™ ë³´ê³ ì„œ | ìƒì„±ì¼ì‹œ: ${new Date().toLocaleString()}</p>
        </div>
    </div>
</body>
</html>`;

                // HTML íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ
                const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `í´ë¦¬ë…¸ë¯¸í„°_ë³´ê³ ì„œ_${data.teamName}_${new Date().getTime()}.html`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                alert('ğŸ“„ HTML ë³´ê³ ì„œê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n\në”ë¸”í´ë¦­í•˜ë©´ ë¸Œë¼ìš°ì €ì—ì„œ ë°”ë¡œ ë³¼ ìˆ˜ ìˆì–´ìš”!');
            });
        }

        // CSV íŒŒì¼ë¡œ ì €ì¥ (ì—‘ì…€ì—ì„œ ì—´ê¸° ê°€ëŠ¥)
        function saveAsCSV() {
            const data = {
                teamName: document.getElementById('teamName').value || 'ë¯¸ì…ë ¥',
                target1: document.getElementById('target1').value || 'ë¯¸ì…ë ¥',
                angle1: document.getElementById('angle1').value || 'ë¯¸ì…ë ¥',
                distance1: document.getElementById('distance1').value || 'ë¯¸ì…ë ¥',
                eyeHeight1: document.getElementById('eyeHeight1').value || 'ë¯¸ì…ë ¥',
                calculatedHeight1: document.getElementById('calculatedHeight1').value || 'ë¯¸ì…ë ¥',
                target2: document.getElementById('target2').value || 'ë¯¸ì…ë ¥',
                angle2: document.getElementById('angle2').value || 'ë¯¸ì…ë ¥',
                distance2: document.getElementById('distance2').value || 'ë¯¸ì…ë ¥',
                eyeHeight2: document.getElementById('eyeHeight2').value || 'ë¯¸ì…ë ¥',
                calculatedHeight2: document.getElementById('calculatedHeight2').value || 'ë¯¸ì…ë ¥',
                reflection: document.getElementById('reflection').value || 'ë¯¸ì…ë ¥',
                photoCount: uploadedFiles.length,
                timestamp: new Date().toLocaleString()
            };

            const headers = [
                'ì œì¶œì¼ì‹œ', 'ëª¨ë‘ ëª…', 
                'ì¸¡ì •ëŒ€ìƒ1', 'ê°ë„1(ë„)', 'ê±°ë¦¬1(m)', 'ëˆˆë†’ì´1(m)', 'ê³„ì‚°ë†’ì´1(m)',
                'ì¸¡ì •ëŒ€ìƒ2', 'ê°ë„2(ë„)', 'ê±°ë¦¬2(m)', 'ëˆˆë†’ì´2(m)', 'ê³„ì‚°ë†’ì´2(m)',
                'í™œë™ì†Œê°', 'ì‚¬ì§„ê°œìˆ˜'
            ];

            const rowData = [
                data.timestamp, data.teamName,
                data.target1, data.angle1, data.distance1, data.eyeHeight1, data.calculatedHeight1,
                data.target2, data.angle2, data.distance2, data.eyeHeight2, data.calculatedHeight2,
                data.reflection, data.photoCount
            ];

            const csvContent = [
                headers.join(','),
                rowData.map(cell => `"${cell}"`).join(',')
            ].join('\n');

            // UTF-8 BOM ì¶”ê°€ (í•œê¸€ ê¹¨ì§ ë°©ì§€)
            const blob = new Blob(['\ufeff' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `í´ë¦¬ë…¸ë¯¸í„°_ë°ì´í„°_${data.teamName}_${new Date().getTime()}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            alert('ğŸ“Š CSV íŒŒì¼ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nì—‘ì…€ì—ì„œ ì—´ì–´ì„œ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”!');
        }

        // êµ¬ê¸€í¼ìœ¼ë¡œ ì œì¶œí•˜ê¸°
        function submitToGoogleForm() {
            const googleFormUrl = document.getElementById('googleFormUrl').value;
            
            if (!googleFormUrl) {
                alert('êµ¬ê¸€í¼ URLì„ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            const data = {
                teamName: document.getElementById('teamName').value || '',
                target1: document.getElementById('target1').value || '',
                angle1: document.getElementById('angle1').value || '',
                distance1: document.getElementById('distance1').value || '',
                eyeHeight1: document.getElementById('eyeHeight1').value || '',
                calculatedHeight1: document.getElementById('calculatedHeight1').value || '',
                target2: document.getElementById('target2').value || '',
                angle2: document.getElementById('angle2').value || '',
                distance2: document.getElementById('distance2').value || '',
                eyeHeight2: document.getElementById('eyeHeight2').value || '',
                calculatedHeight2: document.getElementById('calculatedHeight2').value || '',
                reflection: document.getElementById('reflection').value || '',
                timestamp: new Date().toLocaleString()
            };

            // êµ¬ê¸€í¼ URLì— ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ì…ë ¥í•˜ëŠ” íŒŒë¼ë¯¸í„° ì¶”ê°€
            // ì‹¤ì œë¡œëŠ” êµ¬ê¸€í¼ì˜ entry IDë¥¼ ì•Œì•„ì•¼ í•˜ì§€ë§Œ, ì¼ë‹¨ ê¸°ë³¸ í˜•íƒœë¡œ ë§Œë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤
            let formUrlWithData = googleFormUrl;
            
            // êµ¬ê¸€í¼ì´ /viewformìœ¼ë¡œ ëë‚˜ë©´ ë¯¸ë¦¬ì±„ìš°ê¸° URLë¡œ ë³€ê²½
            if (formUrlWithData.includes('/viewform')) {
                formUrlWithData = formUrlWithData.replace('/viewform', '/viewform?usp=pp_url');
                
                // ë¯¸ë¦¬ì±„ìš°ê¸° íŒŒë¼ë¯¸í„°ë“¤ (ì‹¤ì œë¡œëŠ” í¼ì˜ entry IDê°€ í•„ìš”í•¨)
                const prefillData = [
                    `entry.ëª¨ë‘ ëª…=${encodeURIComponent(data.teamName)}`,
                    `entry.ì¸¡ì •ëŒ€ìƒ1=${encodeURIComponent(data.target1)}`,
                    `entry.ê°ë„1=${encodeURIComponent(data.angle1)}`,
                    `entry.ê±°ë¦¬1=${encodeURIComponent(data.distance1)}`,
                    `entry.ëˆˆë†’ì´1=${encodeURIComponent(data.eyeHeight1)}`,
                    `entry.ê³„ì‚°ë†’ì´1=${encodeURIComponent(data.calculatedHeight1)}`,
                    `entry.ì¸¡ì •ëŒ€ìƒ2=${encodeURIComponent(data.target2)}`,
                    `entry.ê°ë„2=${encodeURIComponent(data.angle2)}`,
                    `entry.ê±°ë¦¬2=${encodeURIComponent(data.distance2)}`,
                    `entry.ëˆˆë†’ì´2=${encodeURIComponent(data.eyeHeight2)}`,
                    `entry.ê³„ì‚°ë†’ì´2=${encodeURIComponent(data.calculatedHeight2)}`,
                    `entry.í™œë™ì†Œê°=${encodeURIComponent(data.reflection)}`
                ].join('&');
                
                // ì‹¤ì œë¡œëŠ” ìœ„ ë°©ë²•ë³´ë‹¤ëŠ” ë‹¨ìˆœí•˜ê²Œ í¼ì„ ì—´ì–´ì£¼ëŠ” ê²ƒì´ ë” ì‹¤ìš©ì 
                formUrlWithData = googleFormUrl;
            }

            // ë°ì´í„° ìš”ì•½ì„ í´ë¦½ë³´ë“œì— ë³µì‚¬
            const summaryText = `
í´ë¦¬ë…¸ë¯¸í„° í™œë™ ê²°ê³¼ - ${data.teamName}

[1ì°¨ ì¸¡ì •]
ì¸¡ì •ëŒ€ìƒ: ${data.target1}
ê°ë„: ${data.angle1}Â°
ê±°ë¦¬: ${data.distance1}m
ëˆˆë†’ì´: ${data.eyeHeight1}m
ê³„ì‚°ë†’ì´: ${data.calculatedHeight1}m

[2ì°¨ ì¸¡ì •]
ì¸¡ì •ëŒ€ìƒ: ${data.target2}
ê°ë„: ${data.angle2}Â°
ê±°ë¦¬: ${data.distance2}m
ëˆˆë†’ì´: ${data.eyeHeight2}m
ê³„ì‚°ë†’ì´: ${data.calculatedHeight2}m

[í™œë™ì†Œê°]
${data.reflection}

ì œì¶œì‹œê°„: ${data.timestamp}
            `.trim();

            // í´ë¦½ë³´ë“œì— ë³µì‚¬
            navigator.clipboard.writeText(summaryText).then(() => {
                alert('ğŸ“‹ ì¸¡ì • ë°ì´í„°ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n\nêµ¬ê¸€í¼ì´ ìƒˆ ì°½ìœ¼ë¡œ ì—´ë¦½ë‹ˆë‹¤.\në¶™ì—¬ë„£ê¸°(Ctrl+V)ë¡œ ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì„¸ìš”!');
                
                // êµ¬ê¸€í¼ì„ ìƒˆ ì°½ìœ¼ë¡œ ì—´ê¸°
                window.open(formUrlWithData, '_blank');
            }).catch(() => {
                // í´ë¦½ë³´ë“œ ë³µì‚¬ê°€ ì‹¤íŒ¨í•˜ë©´ í…ìŠ¤íŠ¸ ì˜ì—­ì— í‘œì‹œ
                showDataForCopy(summaryText, formUrlWithData);
            });
        }

        // ë°ì´í„°ë¥¼ ë³µì‚¬í•  ìˆ˜ ìˆëŠ” íŒì—… í‘œì‹œ
        function showDataForCopy(summaryText, formUrl) {
            const popup = document.createElement('div');
            popup.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;
            
            popup.innerHTML = `
                <div style="
                    background: white;
                    padding: 30px;
                    border-radius: 15px;
                    max-width: 500px;
                    width: 90%;
                    max-height: 80%;
                    overflow-y: auto;
                ">
                    <h3 style="margin-bottom: 20px;">ğŸ“‹ êµ¬ê¸€í¼ì— ì…ë ¥í•  ë°ì´í„°</h3>
                    <textarea 
                        readonly 
                        style="
                            width: 100%;
                            height: 300px;
                            padding: 10px;
                            border: 1px solid #ddd;
                            border-radius: 5px;
                            font-size: 12px;
                            line-height: 1.4;
                        "
                        onclick="this.select()"
                    >${summaryText}</textarea>
                    <div style="margin-top: 20px; text-align: center;">
                        <button onclick="copyToClipboard('${summaryText.replace(/'/g, "\\'")}'); window.open('${formUrl}', '_blank');" 
                                style="background: #4285f4; color: white; border: none; padding: 10px 20px; border-radius: 5px; margin-right: 10px; cursor: pointer;">
                            ğŸ“ ë³µì‚¬í•˜ê³  êµ¬ê¸€í¼ ì—´ê¸°
                        </button>
                        <button onclick="document.body.removeChild(this.parentElement.parentElement.parentElement)" 
                                style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
                            ë‹«ê¸°
                        </button>
                    </div>
                    <p style="font-size: 12px; color: #666; margin-top: 15px;">
                        ğŸ’¡ í…ìŠ¤íŠ¸ ì˜ì—­ì„ í´ë¦­í•˜ë©´ ì „ì²´ ì„ íƒë©ë‹ˆë‹¤.<br>
                        Ctrl+Cë¡œ ë³µì‚¬í•œ í›„ êµ¬ê¸€í¼ì— ë¶™ì—¬ë„£ê¸°í•˜ì„¸ìš”!
                    </p>
                </div>
            `;
            
            document.body.appendChild(popup);
        }

        // êµ¬ê¸€í¼ ì„¤ì • ê°€ì´ë“œ
        function showGoogleFormGuide() {
            const guide = `
ğŸ“ êµ¬ê¸€í¼ ì„¤ì • ê°€ì´ë“œ (ì„ ìƒë‹˜ìš©)

1ï¸âƒ£ êµ¬ê¸€í¼ ë§Œë“¤ê¸°
â€¢ forms.google.com ì ‘ì†
â€¢ ìƒˆ ì„¤ë¬¸ì§€ ë§Œë“¤ê¸°

2ï¸âƒ£ í•„ìˆ˜ ì§ˆë¬¸ í•­ëª©ë“¤
â€¢ ëª¨ë‘ ëª… (ë‹¨ë‹µí˜•)
â€¢ ì¸¡ì •ëŒ€ìƒ1 (ë‹¨ë‹µí˜•)
â€¢ ê°ë„1 (ë‹¨ë‹µí˜•)
â€¢ ê±°ë¦¬1 (ë‹¨ë‹µí˜•) 
â€¢ ëˆˆë†’ì´1 (ë‹¨ë‹µí˜•)
â€¢ ê³„ì‚°ë†’ì´1 (ë‹¨ë‹µí˜•)
â€¢ ì¸¡ì •ëŒ€ìƒ2 (ë‹¨ë‹µí˜•)
â€¢ ê°ë„2 (ë‹¨ë‹µí˜•)
â€¢ ê±°ë¦¬2 (ë‹¨ë‹µí˜•)
â€¢ ëˆˆë†’ì´2 (ë‹¨ë‹µí˜•)
â€¢ ê³„ì‚°ë†’ì´2 (ë‹¨ë‹µí˜•)
â€¢ í™œë™ì†Œê° (ì¥ë¬¸í˜•)
â€¢ í™œë™ì‚¬ì§„ (íŒŒì¼ ì—…ë¡œë“œ)

3ï¸âƒ£ ì„¤ì •
â€¢ 'ì‘ë‹µ ìˆ˜ì§‘' ì¼œê¸°
â€¢ ê³µìœ  ì„¤ì •: ë§í¬ê°€ ìˆëŠ” ëª¨ë“  ì‚¬ìš©ì

4ï¸âƒ£ ë§í¬ ë³µì‚¬
â€¢ ìš°ì¸¡ ìƒë‹¨ 'ë³´ë‚´ê¸°' â†’ ë§í¬ ë³µì‚¬
â€¢ ìœ„ ì…ë ¥ë€ì— ë¶™ì—¬ë„£ê¸°

ğŸ’¡ íŒ: í•™ìƒì´ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì¸¡ì • ë°ì´í„°ê°€ 
í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì–´ í¼ì— ì‰½ê²Œ ë¶™ì—¬ë„£ì„ ìˆ˜ ìˆì–´ìš”!
            `;
            
            alert(guide);
        }

        // ê²°ê³¼ ì •ë¦¬í•˜ê¸° (í˜„ì¬ í˜ì´ì§€ì—ì„œ ë°”ë¡œ ë³´ì—¬ì£¼ê¸°)
        async function showResultSummary() {
            const data = {
                teamName: document.getElementById('teamName').value || 'ë¯¸ì…ë ¥',
                target1: document.getElementById('target1').value || 'ë¯¸ì…ë ¥',
                angle1: document.getElementById('angle1').value || 'ë¯¸ì…ë ¥',
                distance1: document.getElementById('distance1').value || 'ë¯¸ì…ë ¥',
                eyeHeight1: document.getElementById('eyeHeight1').value || 'ë¯¸ì…ë ¥',
                calculatedHeight1: document.getElementById('calculatedHeight1').value || 'ë¯¸ì…ë ¥',
                target2: document.getElementById('target2').value || 'ë¯¸ì…ë ¥',
                angle2: document.getElementById('angle2').value || 'ë¯¸ì…ë ¥',
                distance2: document.getElementById('distance2').value || 'ë¯¸ì…ë ¥',
                eyeHeight2: document.getElementById('eyeHeight2').value || 'ë¯¸ì…ë ¥',
                calculatedHeight2: document.getElementById('calculatedHeight2').value || 'ë¯¸ì…ë ¥',
                reflection: document.getElementById('reflection').value || 'ë¯¸ì…ë ¥',
                timestamp: new Date().toLocaleString()
            };

            // ì‚¬ì§„ì„ Base64ë¡œ ë³€í™˜
            const photoDataList = await Promise.all(uploadedFiles.map(file => {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result);
                    reader.readAsDataURL(file);
                });
            }));

            // ì‚¬ì§„ HTML ìƒì„±
            const photoHtml = photoDataList.map((photoData, index) => 
                `<div style="display: inline-block; margin: 10px; text-align: center;">
                    <img src="${photoData}" style="width: 200px; height: 150px; object-fit: cover; border: 2px solid #ddd; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.2);">
                    <p style="margin: 5px 0; font-size: 12px; color: #666;">ğŸ“· ì‚¬ì§„ ${index + 1}</p>
                </div>`
            ).join('');

            // ê²°ê³¼ ìš”ì•½ ë‚´ìš© ìƒì„±
            const summaryContent = `
                <div style="
                    background: white;
                    max-width: 900px;
                    margin: 20px auto;
                    padding: 30px;
                    border-radius: 20px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
                    font-family: 'Malgun Gothic', sans-serif;
                ">
                    <div style="text-align: center; margin-bottom: 20px;">
                        <button onclick="location.reload()" style="background: #ff6b6b; color: white; border: none; padding: 10px 20px; border-radius: 25px; cursor: pointer; font-size: 14px; font-weight: bold; margin-bottom: 15px;">
                            ğŸ”„ ì›ë˜ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°
                        </button>
                        <p style="margin: 0; color: #636e72; font-size: 14px;">ğŸ“± ì´ í™”ë©´ì„ ìº¡ì²˜í•´ì„œ ëµì»¤ë²¨ì— ì—…ë¡œë“œí•˜ì„¸ìš”!</p>
                    </div>

                    <div style="text-align: center; margin-bottom: 25px; padding-bottom: 20px; border-bottom: 3px solid #74b9ff;">
                        <h1 style="color: #2d3436; margin: 0; font-size: 28px;">ğŸ”­ í´ë¦¬ë…¸ë¯¸í„° í™œë™ ê²°ê³¼</h1>
                        <p style="margin: 10px 0; color: #636e72; font-size: 16px;">ì•¼ì™¸ì—ì„œ ê±´ë¬¼ê³¼ ë‚˜ë¬´ì˜ ë†’ì´ë¥¼ êµ¬í•´ ë³´ì!</p>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; background: linear-gradient(135deg, #e8f4fd, #f8f9fa); padding: 15px 25px; border-radius: 15px; margin-bottom: 25px; border: 2px solid #74b9ff;">
                        <div>
                            <h3 style="margin: 0; color: #2d3436;">ğŸ“‹ ê¸°ë³¸ ì •ë³´</h3>
                            <p style="margin: 5px 0; font-size: 16px;"><strong>ëª¨ë‘ ëª…:</strong> ${data.teamName}</p>
                        </div>
                        <div style="text-align: right;">
                            <p style="margin: 0; color: #636e72; font-size: 14px;"><strong>ì œì¶œì¼ì‹œ:</strong></p>
                            <p style="margin: 0; color: #2d3436; font-size: 14px;">${data.timestamp}</p>
                        </div>
                    </div>

                    <div style="background: linear-gradient(135deg, #74b9ff, #0984e3); color: white; padding: 15px; border-radius: 15px; text-align: center; margin-bottom: 25px; box-shadow: 0 5px 15px rgba(116,185,255,0.4);">
                        <h3 style="margin: 0; font-size: 18px;">ğŸ“ ì¸¡ì • ê³µì‹</h3>
                        <p style="margin: 10px 0; font-size: 16px; font-weight: bold;">ë†’ì´ = (ê±°ë¦¬ Ã— tan(ê°ë„)) + ê´€ì°°ì ëˆˆë†’ì´</p>
                    </div>

                    <h2 style="color: #2d3436; text-align: center; margin: 25px 0 15px 0; font-size: 22px;">ğŸ“Š ì¸¡ì • ê²°ê³¼</h2>
                    <table style="width: 100%; border-collapse: collapse; margin: 20px 0; box-shadow: 0 5px 15px rgba(0,0,0,0.1); border-radius: 10px; overflow: hidden;">
                        <tr>
                            <th style="background: linear-gradient(135deg, #74b9ff, #0984e3); color: white; padding: 15px 10px; text-align: center; font-size: 14px; font-weight: bold;">êµ¬ë¶„</th>
                            <th style="background: linear-gradient(135deg, #74b9ff, #0984e3); color: white; padding: 15px 10px; text-align: center; font-size: 14px; font-weight: bold;">ì¸¡ì • ëŒ€ìƒ</th>
                            <th style="background: linear-gradient(135deg, #74b9ff, #0984e3); color: white; padding: 15px 10px; text-align: center; font-size: 14px; font-weight: bold;">ê°ë„(Â°)</th>
                            <th style="background: linear-gradient(135deg, #74b9ff, #0984e3); color: white; padding: 15px 10px; text-align: center; font-size: 14px; font-weight: bold;">ê±°ë¦¬(m)</th>
                            <th style="background: linear-gradient(135deg, #74b9ff, #0984e3); color: white; padding: 15px 10px; text-align: center; font-size: 14px; font-weight: bold;">ëˆˆë†’ì´(m)</th>
                            <th style="background: linear-gradient(135deg, #74b9ff, #0984e3); color: white; padding: 15px 10px; text-align: center; font-size: 14px; font-weight: bold;">ê³„ì‚°ë†’ì´(m)</th>
                        </tr>
                        <tr style="background: white;">
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-weight: bold; color: #e74c3c; font-size: 14px;">1ì°¨ ì¸¡ì •</td>
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 14px;">${data.target1}</td>
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 14px; font-weight: bold; color: #0984e3;">${data.angle1}</td>
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 14px;">${data.distance1}</td>
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 14px;">${data.eyeHeight1}</td>
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 16px; font-weight: bold; color: #00b894; background: #e8f5e8;">${data.calculatedHeight1}</td>
                        </tr>
                        <tr style="background: #f8f9ff;">
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-weight: bold; color: #e74c3c; font-size: 14px;">2ì°¨ ì¸¡ì •</td>
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 14px;">${data.target2}</td>
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 14px; font-weight: bold; color: #0984e3;">${data.angle2}</td>
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 14px;">${data.distance2}</td>
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 14px;">${data.eyeHeight2}</td>
                            <td style="border: 1px solid #ddd; padding: 12px 8px; text-align: center; font-size: 16px; font-weight: bold; color: #00b894; background: #e8f5e8;">${data.calculatedHeight2}</td>
                        </tr>
                    </table>

                    <div style="background: linear-gradient(135deg, #fff8e1, #ffecb3); border: 2px solid #ffb74d; border-radius: 15px; padding: 20px; margin: 25px 0;">
                        <h3 style="margin: 0 0 15px 0; color: #e65100; font-size: 18px;">ğŸ’­ í™œë™ ì†Œê° ë° ëŠë‚€ ì </h3>
                        <p style="white-space: pre-wrap; line-height: 1.6; font-size: 15px; color: #333; margin: 0;">${data.reflection}</p>
                    </div>

                    ${photoHtml ? `
                    <div style="margin: 25px 0; text-align: center;">
                        <h3 style="color: #2d3436; margin-bottom: 20px; font-size: 20px;">ğŸ“¸ í™œë™ ì‚¬ì§„</h3>
                        <div style="text-align: center;">
                            ${photoHtml}
                        </div>
                    </div>
                    ` : ''}

                    <div style="text-align: center; color: #6c757d; font-size: 14px; margin-top: 30px; padding-top: 20px; border-top: 2px dashed #ddd;">
                        <p style="margin: 0;">ğŸ¯ í´ë¦¬ë…¸ë¯¸í„° í™œë™ ì™„ë£Œ! | ğŸ“¸ ì‚¬ì§„ ${uploadedFiles.length}ê°œ | ğŸ“… ${new Date().toLocaleString()}</p>
                    </div>
                </div>
            `;

            // í˜„ì¬ í˜ì´ì§€ë¥¼ ê²°ê³¼ í™”ë©´ìœ¼ë¡œ ë³€ê²½
            document.body.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    min-height: 100vh;
                    padding: 20px;
                ">
                    ${summaryContent}
                </div>
            `;

            // ìŠ¤í¬ë¡¤ì„ ìœ„ë¡œ ì´ë™
            window.scrollTo(0, 0);

            console.log('ê²°ê³¼ ì •ë¦¬ í™”ë©´ìœ¼ë¡œ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ìë™ ê³„ì‚° ê¸°ëŠ¥ (ì˜µì…˜)
        function calculateHeight(angleId, distanceId, eyeHeightId, resultId) {
            const angle = parseFloat(document.getElementById(angleId).value);
            const distance = parseFloat(document.getElementById(distanceId).value);
            const eyeHeight = parseFloat(document.getElementById(eyeHeightId).value);
            
            if (angle && distance && eyeHeight) {
                const radians = angle * (Math.PI / 180);
                const height = (distance * Math.tan(radians)) + eyeHeight;
                document.getElementById(resultId).value = height.toFixed(2);
            }
        }

        // ì…ë ¥ê°’ ë³€ê²½ì‹œ ìë™ ê³„ì‚°
        ['angle1', 'distance1', 'eyeHeight1'].forEach(id => {
            document.getElementById(id).addEventListener('input', () => {
                calculateHeight('angle1', 'distance1', 'eyeHeight1', 'calculatedHeight1');
            });
        });

        ['angle2', 'distance2', 'eyeHeight2'].forEach(id => {
            document.getElementById(id).addEventListener('input', () => {
                calculateHeight('angle2', 'distance2', 'eyeHeight2', 'calculatedHeight2');
            });
        });
    </script>
</body>
</html>
